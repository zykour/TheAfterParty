@using TheAfterParty.Domain.Entities
@using TheAfterParty.WebUI.Models.Store
@model AdminListingViewModel

@{
    ViewBag.Title = "View Listings";
}

<h2>View Listings</h2>

<div class="container">
    <div class="row">
        <div class="col-lg-3">Actions</div>
        <div class="col-lg-4">Name</div>
        <div class="col-lg-1">Price</div>
        <div class="col-lg-1">Quantity</div>
        <div class="col-lg-3">Date Edited</div>
    </div>
    @foreach (Listing listing in Model.Listings)
    {
        <div class="row">
            <div class="col-lg-3">
                @Html.ActionLink("Edit", "EditListing", "Store", new { id = listing.ListingID }, null)
                @Html.ActionLink("Del", "DeleteListing", "Store", new { id = listing.ListingID }, null)
                @if (listing.Product != null) { Html.ActionLink("Edit", "EditListing", "Store", new { id = listing.ListingID }, null) }
            </div>
            <div class="col-lg-4">@listing.ListingName</div>
            <div class="col-lg-1">@listing.ListingPrice</div>
            <div class="col-lg-1">@listing.Quantity</div>
            <div class="col-lg-3">@listing.DateEdited</div>
        </div>

        if (listing?.DiscountedListings.Count > 1)
        {
            for (int i = 0; i < listing.DiscountedListings.Count; i++)
            {
            <div class="row">
                <div class="col-lg-3">
                    @Html.ActionLink("Edit", "EditDiscountedListing", "Store", new { id = listing.DiscountedListings.ElementAt(i).DiscountedListingID }, null)
                </div>
                <div class="col-lg-1">@((listing.DiscountedListings.ElementAt(i).WeeklyDeal) ? "Weekly" : ""</div>
                <div class="col-lg-1">@((listing.DiscountedListings.ElementAt(i).DailyDeal) ? "Daily" : ""</div>
                <div class="col-lg-3">@listing.DiscountedListings.ElementAt(i).ItemDiscountPercent</div>
                <div class="col-lg-4">@listing.DiscountedListings.ElementAt(i).ItemSaleExpiry</div>
            </div>
            }
        }
    }
</div>
<a href="/Store/AddGames/">Add Games</a>